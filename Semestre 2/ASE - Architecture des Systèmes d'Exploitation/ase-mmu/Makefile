# Les règles de compilation peuvent utiliser les variables suivantes
# Consultez la documentation de make pour en savoir plus (et en
# trouver d’autres)
#
# $@  Le nom de la cible
# $<  Le nom de la première dépendance
# $^  La liste des dépendances



ROOTDIR = .
LIBNAME = hardware

LIBDIR  = $(ROOTDIR)/lib
INCDIR  = $(ROOTDIR)/include
LDLIBS  = -L$(LIBDIR) -l$(LIBNAME)



# Compilateur C et éditeur de liens
CC       =  gcc

# Options pour la compilation .c -> .o
CFLAGS   = -Wall -Wextra -I$(INCDIR)

# Active les informations de débogage
CFLAGS  += -g

# Options pour l’édition de liens .o -> binaire
LDFLAGS += -g



# Nom des exécutables
ALL:= mmu exercice3

# Argument qui sera construit si aucun n'a pas été précisé à "make"
all: ${ALL}



# Arguments qui seront construits
%: %.o
	${CC} ${LDFLAGS} $(LDLIBS) -o $@ $^

%.o: %.c
	${CC} ${CFLAGS} -c $<

%.s: %.c
	${CC} ${CFLAGS} -S $<



# Arguments qui nettoie l'arborescence des fichiers devenus inutiles
clean:
	rm -f core *.o *.s

realclean: clean
	rm -f ${ALL}



.PHONY: all clean realclean
